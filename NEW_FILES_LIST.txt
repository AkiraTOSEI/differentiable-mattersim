# æ–°è¦è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ

## ã‚³ã‚¢å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

1. src/mattersim/utils/geometry_torch.py
   - torch ãƒ™ãƒ¼ã‚¹ã®å¹¾ä½•æ¼”ç®—ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
   - æ ¼å­å¤‰æ›ã€åº§æ¨™å¤‰æ›ãªã©

2. src/mattersim/datasets/utils/differentiable_convertor.py
   - DifferentiableGraphBuilder ã‚¯ãƒ©ã‚¹
   - å›ºå®šãƒˆãƒãƒ­ã‚¸ãƒ¼ã§å¾®åˆ†å¯èƒ½ãª Graph æ§‹ç¯‰

3. src/mattersim/forcefield/m3gnet/differentiable_m3gnet.py
   - DifferentiableM3Gnet ã‚¯ãƒ©ã‚¹
   - é€£ç¶šå€¤ one-hot ã‚’æ‰±ã†å¾®åˆ†å¯èƒ½ãª M3GNet

4. src/mattersim/forcefield/differentiable_potential.py
   - DifferentiableMatterSimCalculator ã‚¯ãƒ©ã‚¹
   - ãƒ¡ã‚¤ãƒ³ã®å¾®åˆ†å¯èƒ½ API

## ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ¢ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

5. tests/test_differentiable.py
   - å›å¸°ãƒ†ã‚¹ãƒˆã€å‹¾é…ãƒ†ã‚¹ãƒˆã€æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ
   - 8ã¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

6. scripts/generate_baseline.py
   - Baseline ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
   - Diamond Si ã¨ FCC-Fe ã®å‡ºåŠ›ã‚’ä¿å­˜

7. examples/differentiable_demo.py
   - ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ç”¨ãƒ‡ãƒ¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
   - 3ã¤ã®ãƒ‡ãƒ¢ï¼ˆå‹¾é…ã€æ§‹é€ æœ€é©åŒ–ã€æ ¼å­æœ€é©åŒ–ï¼‰

8. examples/differentiable_mattersim_demo.ipynb
   - Jupyter Notebook ç”¨ãƒ‡ãƒ¢
   - 5ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåŸºæœ¬ã€æ§‹é€ æœ€é©åŒ–ã€æ ¼å­æœ€é©åŒ–ã€åŒæ™‚æœ€é©åŒ–ã€ã¾ã¨ã‚ï¼‰

## ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

9. tests/data/baseline_outputs.json
   - å›å¸°ãƒ†ã‚¹ãƒˆç”¨ baseline ãƒ‡ãƒ¼ã‚¿
   - Diamond Si ã¨ FCC-Fe ã®å‡ºåŠ›

10. docs/DIFFERENTIABLE_API.md
    - API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    - ä½¿ã„æ–¹ã€åˆ¶é™äº‹é …ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©

## å¤‰æ›´ã‚µãƒãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ1ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

11. CHANGES.md
    - ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
    - å¤‰æ›´å†…å®¹ã®è©³ç´°ã‚µãƒãƒªãƒ¼

## åˆè¨ˆ: 11ãƒ•ã‚¡ã‚¤ãƒ«



 ---
  ğŸ“¦ å…¨ä½“ã®ã‚µãƒãƒªãƒ¼

  æ–°è¦è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ11ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

  ã‚³ã‚¢å®Ÿè£…ï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

  1. âœ… src/mattersim/utils/geometry_torch.py
  2. âœ… src/mattersim/datasets/utils/differentiable_convertor.py
  3. âœ… src/mattersim/forcefield/m3gnet/differentiable_m3gnet.py
  4. âœ… src/mattersim/forcefield/differentiable_potential.py

  ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ¢ï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

  5. âœ… tests/test_differentiable.py
  6. âœ… scripts/generate_baseline.py
  7. âœ… examples/differentiable_demo.py
  8. âœ… examples/differentiable_mattersim_demo.ipynb â† æ–°è¦ä½œæˆ

  ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

  9. âœ… tests/data/baseline_outputs.json
  10. âœ… docs/DIFFERENTIABLE_API.md
  11. âœ… CHANGES.md â† æ–°è¦ä½œæˆ
  12. âœ… NEW_FILES_LIST.txt â† æ–°è¦ä½œæˆ

  ãƒ†ã‚¹ãƒˆçµæœ

  $ python tests/test_differentiable.py -v

  å…¨ 8 ãƒ†ã‚¹ãƒˆ pass âœ…

  ä½¿ç”¨æ–¹æ³•

  Jupyter Notebook ãƒ‡ãƒ¢

  jupyter notebook examples/differentiable_mattersim_demo.ipynb

  ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¢

  python examples/differentiable_demo.py

  ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

  python tests/test_differentiable.py -v

  ã‚³ãƒ¼ãƒ‰ã§ã®ä½¿ç”¨

  import torch
  from ase.build import bulk
  from mattersim.forcefield.differentiable_potential import DifferentiableMatterSimCalculator

  si = bulk("Si", "diamond", a=5.43)
  calc = DifferentiableMatterSimCalculator(device="cpu")

  positions = torch.tensor(si.get_positions(), dtype=torch.float32, requires_grad=True)
  output = calc.forward(si, positions=positions)
  energy = output["total_energy"]

  energy.backward()
  print(positions.grad)  # åº§æ¨™ã¸ã®å‹¾é…

  ---
  ã™ã¹ã¦ã®å®Ÿè£…ãŒå®Œäº†ã—ã€Jupyter Notebook ãƒ‡ãƒ¢ã¨å·®åˆ†ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ä½œæˆã—ã¾ã—ãŸï¼ğŸ‰
